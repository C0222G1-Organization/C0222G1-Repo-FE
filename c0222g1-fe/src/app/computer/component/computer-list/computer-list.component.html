<div class="container mt-5" id="table-computer">
  <div class="row">
    <h2 class="text-center text-white">DANH SÁCH MÁY</h2>
  </div>
  <div class="row">
    <div class="container">
      <div class="">
        <div class="container-input">
          <div class="form">
            <form [formGroup]="formSearch">
              <div class="fields">
                <div class="input-field input-search">
                  <label>Mã máy</label>
                  <input type="text" class="input-search" formControlName="code" placeholder="Nhập mã máy">
                </div>
                <div class="input-field">
                  <label>Ngày bắt đầu</label>
                  <input type="date" formControlName="start" class="input-search">
                  <span style="color: red; font-size: 0.8rem" *ngIf="formSearch.get('start').dirty
                && formSearch.hasError('invalid', 'start')">Ngày bắt đầu phải nhỏ hơn hoặc bằng ngày hiện tại</span>
                </div>
                <div class="input-field">
                  <label>Trạng thái</label>
                  <select style="min-width: 100px" formControlName="status" class="input-search form-select">
                    <option value="">--Chọn trạng thái--</option>
                    <option value="0">Bình thường</option>
                    <option value="1">Bảo trì</option>
                  </select>
                </div>
                <div class="input-field">
                  <label>Vị trí</label>
                  <input type="text" class="input-search" formControlName="location" placeholder="Nhập vị trí máy">
                </div>
                <div class="input-field">
                  <label>Ngày kết thúc</label>
                  <input type="date" formControlName="end" class="input-search">
                  <span style="color: red; font-size: 0.8rem" *ngIf="formSearch.get('end').dirty
                && formSearch.hasError('invalid', 'end')">Ngày kết thúc phải lớn ngày hiện tại</span>
                </div>
                <div class="input-field">
                  <label>Loại máy</label>
                  <select style="min-width: 100px" formControlName="typeId" class="input-search form-select">
                    <option value="">--Chọn loại máy--</option>
                    <option *ngFor="let type of computerTypes" value="{{type.id}}">Máy {{type.name}}</option>
                  </select>
                </div>
              </div>
            </form>
            <div class="input-field">
              <button class="btn btn-outline-secondary mb-2" (click)="findAll()" style="right: 0">Tìm kiếm</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="container">
      <table class="table table-dark w-100">
        <thead>
        <tr>
          <th scope="col">
            <input type="checkbox" [checked]="isAllCheckBoxChecked()" (change)="checkAllCheckBox($event)">
            #
          </th>
          <th scope="col">ID Máy</th>
          <th scope="col">Trạng thái</th>
          <th scope="col">Vị trí</th>
          <th scope="col">Thời gian bắt đầu</th>
          <th scope="col">Cấu hình</th>
          <th scope="col">Loại máy</th>
          <th scope="col">Nhà sản xuất</th>
          <th scope="col">Bảo hành</th>
          <th scope="col">Chức năng</th>
        </tr>
        </thead>
        <tbody>
        <tr
          *ngFor="let computer of computers | paginate : { itemsPerPage: 4, currentPage: page + 1, totalItems: totalItems}; index as i">
          <td>
            <input class="card-notify-year-checkbox" type="checkbox" value="{{computer.id}}"
                   [(ngModel)]="computers[i].checked">
            {{computer.id}}
          </td>
          <td>{{computer.code}}</td>
          <td *ngIf="computer.status.includes('true',0)">Bình thường</td>
          <td *ngIf="computer.status.includes('false',0)">Bảo trì</td>
          <td>{{computer.location}}</td>
          <td>{{computer.start | date: "dd/MM/yyyy"}}</td>
          <td>{{computer.configuration}}</td>
          <td *ngIf="computer.type.includes('1',0)">Vip</td>
          <td *ngIf="computer.type.includes('2',0)">Thường</td>
          <td>{{computer.manufacturer}}</td>
          <td>{{computer.warranty}} năm</td>
          <td>
            <button class="btn btn-outline-secondary color-icon" routerLink="/computers/edit/{{computer.id}}"><i class="fa-solid fa-pencil"></i></button>
            <button class="btn btn-outline-secondary " (click)="getInfo(computer)" data-bs-toggle="modal"
                    data-bs-target="#deleteModal"><i class="fa-solid fa-trash"></i></button>
          </td>
        </tr>
        <tr *ngIf="computers.length == 0">
          <td colspan="10">
            <div class="container mt-2 justify-content-center">
              <img src="https://i.pinimg.com/originals/73/b0/05/73b0054acf8be08b254ba90945a19d09.gif" style="width: 100%; height: 400px">
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="row d-flex" id="btn-outside">
    <div class="col-4">
      <button class="btn btn-primary m-2" routerLink="/computers/create">Thêm mới máy</button>
    </div>
    <div class="col-4"></div>
    <div class="col-4">
      <div class="float-end">
        <button class="btn btn-danger m-2" data-bs-toggle="modal"
                data-bs-target="#deleteAllModal">Xóa
        </button>
      </div>
    </div>
  </div>
  <div *ngIf="computers.length > 0" style="justify-content: space-around;display: flex;">
    <pagination-controls nextLabel="Trang sau" previousLabel="Trang trước" (pageChange)="getPage($event)"></pagination-controls>
  </div>
</div>

<!--Start Delete Modal-->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel1">Xác nhận thông tin máy</h5>
      </div>
      <div class="modal-body">
        Bạn có chắc chắn muốn xóa máy có mã máy là <span
        style="font-weight: bold; color: #ff4146">{{computerCodeDelete}}</span> không?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
        <button type="button" class="btn btn-primary" (click)="delete()" data-bs-dismiss="modal">Xóa</button>
      </div>
    </div>
  </div>
</div>
<!--End Delete Modal-->

<!--Start Delete Modal-->
<div class="modal fade" id="deleteAllModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Xác nhận thông tin máy</h5>
      </div>
      <div class="modal-body">
        <div *ngIf="map.size == 0" style="color: #ff4146;">
          Không có máy nào được chọn!
        </div>
        <div class="container" *ngIf="map.size != 0">
          Danh sách các máy muốn xóa:
          <table class="table table-dark w-100">
            <tr *ngFor="let c of map | keyvalue; index as i">
              <td>{{i + 1}}</td>
              <td style="font-weight: bold; color: #ff4146">{{c.value.code}}</td>
            </tr>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
        <button type="button" class="btn btn-primary" (click)="deleteMultiComputer()" data-bs-dismiss="modal">Xóa</button>
      </div>
    </div>
  </div>
</div>
<!--End Delete Modal-->
